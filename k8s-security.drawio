<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.7.8 Chrome/128.0.6613.36 Electron/32.0.1 Safari/537.36" version="24.7.8" pages="2">
  <diagram name="第 1 页" id="3rMTS21RZY5TvqJ1PF2R">
    <mxGraphModel dx="1742" dy="674" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="18zcvahHCD0DxNo0-nxQ-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="18zcvahHCD0DxNo0-nxQ-1" target="18zcvahHCD0DxNo0-nxQ-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="18zcvahHCD0DxNo0-nxQ-1" target="18zcvahHCD0DxNo0-nxQ-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-1" value="Pod 安全性标准" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="140" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-2" value="Privileged&lt;div style=&quot;line-height: 200%;&quot;&gt;（无限制）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;spacing=2;" vertex="1" parent="1">
          <mxGeometry x="-60" y="250" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-3" value="Baseline&lt;div style=&quot;line-height: 200%;&quot;&gt;（弱限制）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="250" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-4" value="Restricted&lt;div style=&quot;line-height: 200%;&quot;&gt;（强限制）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="590" y="250" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-10" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;1. 禁止使用宿主机命名空间：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.hostNetwork&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.hostPID&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.hostIPC&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="362" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-14" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;2. 禁止使用特权容器：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.containers[*].securityContext.privileged&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.initContainers[*].securityContext.privileged&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.ephemeralContainers[*].securityContext.privileged&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="431" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-20" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;3. capabilities 限制（只能使用指定的权能）：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.containers[*].securityContext.&lt;/span&gt;&lt;span style=&quot;&quot;&gt;capabilities&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.initContainers[*].securityContext.&lt;span style=&quot;background-color: initial;&quot;&gt;capabilities&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.ephemeralContainers[*].securityContext.&lt;span style=&quot;background-color: initial;&quot;&gt;capabilities&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="508" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-22" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;4. 禁止使用 HostPath 卷：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.volumes[*].hostPath&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="585" width="340" height="40" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-23" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;5. 完全禁止或只使用确定的宿主机端口：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.containers[*].ports[*].&lt;/span&gt;&lt;span style=&quot;&quot;&gt;hostPort&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.initContainers[*].&lt;span style=&quot;background-color: initial;&quot;&gt;ports[*].&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;hostPort&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.ephemeralContainers[*].&lt;span style=&quot;background-color: initial;&quot;&gt;ports[*].&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;hostPort&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="632" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="18zcvahHCD0DxNo0-nxQ-1" target="18zcvahHCD0DxNo0-nxQ-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="18zcvahHCD0DxNo0-nxQ-28" value="&lt;span style=&quot;&quot;&gt;&lt;b&gt;6. AppArmor 策略限制：&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;securityContext.appArmorProfile.type&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.containers[*].securityContext.appArmorProfile.type&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.initContainers[*].&lt;span style=&quot;background-color: initial;&quot;&gt;securityContext.appArmorProfile.type&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;spec.ephemeralContainers[*].&lt;span style=&quot;background-color: initial;&quot;&gt;securityContext.appArmorProfile.type&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="720" width="410" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="6YvifYcSdWFhzTJ6X2rf" name="第 2 页">
    <mxGraphModel dx="1434" dy="854" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="yZPBg5LG-6DMejI-Svt0-16" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="30" y="30" width="780" height="470" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-15" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="30" y="550" width="950" height="345" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-1" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;apiVersion: v1&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;kind: Pod&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;metadata:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; name: pod&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;spec:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;securityContext:&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; seccompProfile:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/font&gt;&lt;font color=&quot;#3333ff&quot; style=&quot;font-size: 15px;&quot;&gt;type: Unconfined&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; initContainers:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; - name: init-container&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; image: debian&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;securityContext:&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; seccompProfile:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#3333ff&quot; style=&quot;font-size: 15px;&quot;&gt; type: RuntimeDefault&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; containers:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; - name: container&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; image: docker.io/library/debian:stable&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;securityContext:&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; seccompProfile:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#cc0000&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/font&gt;&lt;font color=&quot;#3333ff&quot; style=&quot;font-size: 15px;&quot;&gt;type: Localhost&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font color=&quot;#3333ff&quot; style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; localhostProfile: my-profile.json&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;br style=&quot;font-size: 15px;&quot;&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#f5f5f5;fontColor=#333333;strokeColor=none;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="60" y="60" width="330" height="410" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-3" value="&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &amp;quot;liberation mono&amp;quot;, &amp;quot;courier new&amp;quot;, monospace; font-size: 14px; margin-top: 0px; margin-bottom: 0px; overflow: auto; color: rgb(34, 34, 34); overflow-wrap: normal; background-color: rgb(248, 248, 248); padding: 1rem; text-align: left; tab-size: 4;&quot; tabindex=&quot;0&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &amp;quot;liberation mono&amp;quot;, &amp;quot;courier new&amp;quot;, monospace; color: inherit; overflow-wrap: break-word; word-break: normal; padding: 0px; margin: 0px; border: 0px; font-size: 14px; background-color: inherit !important;&quot; data-lang=&quot;json&quot; class=&quot;language-json&quot;&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;{&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;  &lt;span style=&quot;box-sizing: border-box; color: green; font-weight: 700; font-size: 14px;&quot;&gt;&quot;defaultAction&quot;&lt;/span&gt;: &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;SCMP_ACT_ERRNO&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;  &lt;span style=&quot;box-sizing: border-box; color: green; font-weight: 700; font-size: 14px;&quot;&gt;&quot;defaultErrnoRet&quot;&lt;/span&gt;: &lt;span style=&quot;box-sizing: border-box; color: rgb(102, 102, 102); font-size: 14px;&quot;&gt;38&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;  &lt;span style=&quot;box-sizing: border-box; color: green; font-weight: 700; font-size: 14px;&quot;&gt;&quot;syscalls&quot;&lt;/span&gt;: [&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;    {&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;      &lt;span style=&quot;box-sizing: border-box; color: green; font-weight: 700; font-size: 14px;&quot;&gt;&quot;names&quot;&lt;/span&gt;: [&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;adjtimex&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;alarm&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;bind&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;waitid&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;waitpid&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;write&quot;&lt;/span&gt;,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;writev&quot;&lt;/span&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;      ],&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;      &lt;span style=&quot;box-sizing: border-box; color: green; font-weight: 700; font-size: 14px;&quot;&gt;&quot;action&quot;&lt;/span&gt;: &lt;span style=&quot;box-sizing: border-box; color: rgb(187, 68, 68); font-size: 14px;&quot;&gt;&quot;SCMP_ACT_ALLOW&quot;&lt;/span&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;    }&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;  ]&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;box-sizing: border-box; display: flex; font-size: 14px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 14px;&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="450" y="130" width="320" height="340" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-6" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="310" y="440" as="sourcePoint" />
            <mxPoint x="440" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-7" value="&lt;div style=&quot;font-size: 14px;&quot;&gt;apiVersion: v1&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;kind: Pod&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;metadata:&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; name: hello-apparmor&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;spec:&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &lt;font style=&quot;font-size: 14px;&quot; color=&quot;#7f00ff&quot;&gt;securityContext:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#7f00ff&quot;&gt;&amp;nbsp; &amp;nbsp; appArmorProfile:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#7f00ff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; type: Localhost&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#7f00ff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; localhostProfile: k8s-apparmor-example-deny-write&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; containers:&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; - name: hello&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; image: busybox:1.28&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; command: [ &quot;sh&quot;, &quot;-c&quot;, &quot;echo &#39;Hello AppArmor!&#39; &amp;amp;&amp;amp; sleep 1h&quot; ]&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fillColor=#f5f5f5;fontColor=#333333;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="60" y="580" width="410" height="250" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-9" value="#include &amp;lt;tunables/global&amp;gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;profile k8s-apparmor-example-deny-write flags=(attach_disconnected) {&lt;br style=&quot;font-size: 14px;&quot;&gt;  #include &amp;lt;abstractions/base&amp;gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;  file,&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;  # Deny all file writes.&lt;br style=&quot;font-size: 14px;&quot;&gt;  deny /** w,&lt;br style=&quot;font-size: 14px;&quot;&gt;}" style="text;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;html=1;fontSize=14;fillColor=#f9f7ed;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="490" y="645" width="460" height="185" as="geometry" />
        </mxCell>
        <mxCell id="yZPBg5LG-6DMejI-Svt0-14" value="" style="endArrow=classic;html=1;rounded=0;entryX=-0.008;entryY=0.195;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.833;exitY=0.6;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="yZPBg5LG-6DMejI-Svt0-7" target="yZPBg5LG-6DMejI-Svt0-9">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="590" as="sourcePoint" />
            <mxPoint x="550" y="540" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
